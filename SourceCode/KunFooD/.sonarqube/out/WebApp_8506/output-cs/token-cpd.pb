«
rC:\Users\Tamara\Desktop\Work\Anul 3\DotNet\Proiect\KunFooD\SourceCode\KunFooD\WebApp\Controllers\HomeController.cs
	namespace 	
WebApp
 
. 
Controllers 
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
public		 
IActionResult		 
Index		 "
(		" #
)		# $
{

 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
About "
(" #
)# $
{ 	
ViewData 
[ 
$str 
] 
=  !
$str" F
;F G
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Contact $
($ %
)% &
{ 	
ViewData 
[ 
$str 
] 
=  !
$str" 6
;6 7
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Error "
(" #
)# $
{ 	
return 
View 
( 
new 
ErrorViewModel *
{+ ,
	RequestId- 6
=7 8
Activity9 A
.A B
CurrentB I
?I J
.J K
IdK M
??N P
HttpContextQ \
.\ ]
TraceIdentifier] l
}m n
)n o
;o p
} 	
}   
}!! ¯N
sC:\Users\Tamara\Desktop\Work\Anul 3\DotNet\Proiect\KunFooD\SourceCode\KunFooD\WebApp\Controllers\UsersController.cs
	namespace

 	
WebApp


 
.

 
Controllers

 
{ 
public 

class 
UsersController  
:! "

Controller# -
{ 
private 
readonly 
DatabaseContext (
_context) 1
;1 2
public 
UsersController 
( 
DatabaseContext .
context/ 6
)6 7
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
return 
View 
( 
await 
_context &
.& '
Users' ,
., -
ToListAsync- 8
(8 9
)9 :
): ;
;; <
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Details) 0
(0 1
Guid1 5
?5 6
id7 9
)9 :
{ 	
if 
( 
id 
== 
null 
) 
{ 
return   
NotFound   
(    
)    !
;  ! "
}!! 
var## 
user## 
=## 
await## 
_context## %
.##% &
Users##& +
.$$  
SingleOrDefaultAsync$$ %
($$% &
m$$& '
=>$$( *
m$$+ ,
.$$, -
Id$$- /
==$$0 2
id$$3 5
)$$5 6
;$$6 7
if%% 
(%% 
user%% 
==%% 
null%% 
)%% 
{&& 
return'' 
NotFound'' 
(''  
)''  !
;''! "
}(( 
return** 
View** 
(** 
user** 
)** 
;** 
}++ 	
public.. 
IActionResult.. 
Create.. #
(..# $
)..$ %
{// 	
return00 
View00 
(00 
)00 
;00 
}11 	
[66 	
HttpPost66	 
]66 
[77 	$
ValidateAntiForgeryToken77	 !
]77! "
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (
Create88) /
(88/ 0
[880 1
FromBody881 9
]889 :
CreateUsers88; F
createUsers88G R
)88R S
{99 	
User:: 
user:: 
=:: 
Data:: 
.:: 
Domain:: #
.::# $
User::$ (
.::( )
Create::) /
(::/ 0
createUsers::0 ;
.::; <
Name::< @
,::@ A
createUsers::B M
.::M N
IsAdmin::N U
,::U V
createUsers::W b
.::b c
Password::c k
,::k l
createUsers::m x
.::x y
Token::y ~
,::~ 
createUsers
::Ä ã
.
::ã å
Description
::å ó
)
::ó ò
;
::ò ô
if;; 
(;; 

ModelState;; 
.;; 
IsValid;; "
);;" #
{<< 
_context== 
.== 
Add== 
(== 
user== !
)==! "
;==" #
await>> 
_context>> 
.>> 
SaveChangesAsync>> /
(>>/ 0
)>>0 1
;>>1 2
return?? 
RedirectToAction?? '
(??' (
nameof??( .
(??. /
Index??/ 4
)??4 5
)??5 6
;??6 7
}@@ 
returnAA 
ViewAA 
(AA 
userAA 
)AA 
;AA 
}BB 	
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (
EditEE) -
(EE- .
GuidEE. 2
?EE2 3
idEE4 6
)EE6 7
{FF 	
ifGG 
(GG 
idGG 
==GG 
nullGG 
)GG 
{HH 
returnII 
NotFoundII 
(II  
)II  !
;II! "
}JJ 
varLL 
userLL 
=LL 
awaitLL 
_contextLL %
.LL% &
UsersLL& +
.LL+ , 
SingleOrDefaultAsyncLL, @
(LL@ A
mLLA B
=>LLC E
mLLF G
.LLG H
IdLLH J
==LLK M
idLLN P
)LLP Q
;LLQ R
ifMM 
(MM 
userMM 
==MM 
nullMM 
)MM 
{NN 
returnOO 
NotFoundOO 
(OO  
)OO  !
;OO! "
}PP 
returnQQ 
ViewQQ 
(QQ 
userQQ 
)QQ 
;QQ 
}RR 	
[WW 	
HttpPostWW	 
]WW 
[XX 	$
ValidateAntiForgeryTokenXX	 !
]XX! "
publicYY 
asyncYY 
TaskYY 
<YY 
IActionResultYY '
>YY' (
EditYY) -
(YY- .
GuidYY. 2
idYY3 5
,YY5 6
[YY7 8
BindYY8 <
(YY< =
$strYY= s
)YYs t
]YYt u
UserYYv z
userYY{ 
)	YY Ä
{ZZ 	
if[[ 
([[ 
id[[ 
!=[[ 
user[[ 
.[[ 
Id[[ 
)[[ 
{\\ 
return]] 
NotFound]] 
(]]  
)]]  !
;]]! "
}^^ 
if`` 
(`` 

ModelState`` 
.`` 
IsValid`` "
)``" #
{aa 
trybb 
{cc 
_contextdd 
.dd 
Updatedd #
(dd# $
userdd$ (
)dd( )
;dd) *
awaitee 
_contextee "
.ee" #
SaveChangesAsyncee# 3
(ee3 4
)ee4 5
;ee5 6
}ff 
catchgg 
(gg (
DbUpdateConcurrencyExceptiongg 3
)gg3 4
{hh 
ifii 
(ii 
!ii 

UserExistsii #
(ii# $
userii$ (
.ii( )
Idii) +
)ii+ ,
)ii, -
{jj 
returnkk 
NotFoundkk '
(kk' (
)kk( )
;kk) *
}ll 
elsemm 
{nn 
throwoo 
;oo 
}pp 
}qq 
returnrr 
RedirectToActionrr '
(rr' (
nameofrr( .
(rr. /
Indexrr/ 4
)rr4 5
)rr5 6
;rr6 7
}ss 
returntt 
Viewtt 
(tt 
usertt 
)tt 
;tt 
}uu 	
publicxx 
asyncxx 
Taskxx 
<xx 
IActionResultxx '
>xx' (
Deletexx) /
(xx/ 0
Guidxx0 4
?xx4 5
idxx6 8
)xx8 9
{yy 	
ifzz 
(zz 
idzz 
==zz 
nullzz 
)zz 
{{{ 
return|| 
NotFound|| 
(||  
)||  !
;||! "
}}} 
var 
user 
= 
await 
_context %
.% &
Users& +
.
ÄÄ "
SingleOrDefaultAsync
ÄÄ %
(
ÄÄ% &
m
ÄÄ& '
=>
ÄÄ( *
m
ÄÄ+ ,
.
ÄÄ, -
Id
ÄÄ- /
==
ÄÄ0 2
id
ÄÄ3 5
)
ÄÄ5 6
;
ÄÄ6 7
if
ÅÅ 
(
ÅÅ 
user
ÅÅ 
==
ÅÅ 
null
ÅÅ 
)
ÅÅ 
{
ÇÇ 
return
ÉÉ 
NotFound
ÉÉ 
(
ÉÉ  
)
ÉÉ  !
;
ÉÉ! "
}
ÑÑ 
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
user
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 	
[
ää 	
HttpPost
ää	 
,
ää 

ActionName
ää 
(
ää 
$str
ää &
)
ää& '
]
ää' (
[
ãã 	&
ValidateAntiForgeryToken
ãã	 !
]
ãã! "
public
åå 
async
åå 
Task
åå 
<
åå 
IActionResult
åå '
>
åå' (
DeleteConfirmed
åå) 8
(
åå8 9
Guid
åå9 =
id
åå> @
)
åå@ A
{
çç 	
var
éé 
user
éé 
=
éé 
await
éé 
_context
éé %
.
éé% &
Users
éé& +
.
éé+ ,"
SingleOrDefaultAsync
éé, @
(
éé@ A
m
ééA B
=>
ééC E
m
ééF G
.
ééG H
Id
ééH J
==
ééK M
id
ééN P
)
ééP Q
;
ééQ R
_context
èè 
.
èè 
Users
èè 
.
èè 
Remove
èè !
(
èè! "
user
èè" &
)
èè& '
;
èè' (
await
êê 
_context
êê 
.
êê 
SaveChangesAsync
êê +
(
êê+ ,
)
êê, -
;
êê- .
return
ëë 
RedirectToAction
ëë #
(
ëë# $
nameof
ëë$ *
(
ëë* +
Index
ëë+ 0
)
ëë0 1
)
ëë1 2
;
ëë2 3
}
íí 	
private
îî 
bool
îî 

UserExists
îî 
(
îî  
Guid
îî  $
id
îî% '
)
îî' (
{
ïï 	
return
ññ 
_context
ññ 
.
ññ 
Users
ññ !
.
ññ! "
Any
ññ" %
(
ññ% &
e
ññ& '
=>
ññ( *
e
ññ+ ,
.
ññ, -
Id
ññ- /
==
ññ0 2
id
ññ3 5
)
ññ5 6
;
ññ6 7
}
óó 	
}
òò 
}ôô ∞
hC:\Users\Tamara\Desktop\Work\Anul 3\DotNet\Proiect\KunFooD\SourceCode\KunFooD\WebApp\DTOs\CreateUsers.cs
	namespace 	
WebApp
 
. 
DTO 
{ 
public 

class 
CreateUsers 
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 
IsAdmin 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Token 
{ 
get !
;! "
set# &
;& '
}( )
public		 
string		 
Description		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
}

 
} µ
mC:\Users\Tamara\Desktop\Work\Anul 3\DotNet\Proiect\KunFooD\SourceCode\KunFooD\WebApp\Models\ErrorViewModel.cs
	namespace 	
WebApp
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
	RequestId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 Ë
_C:\Users\Tamara\Desktop\Work\Anul 3\DotNet\Proiect\KunFooD\SourceCode\KunFooD\WebApp\Program.cs
	namespace 	
WebApp
 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{		 	
BuildWebHost

 
(

 
args

 
)

 
.

 
Run

 "
(

" #
)

# $
;

$ %
} 	
public 
static 
IWebHost 
BuildWebHost +
(+ ,
string, 2
[2 3
]3 4
args5 9
)9 :
=>; =
WebHost 
.  
CreateDefaultBuilder (
(( )
args) -
)- .
. 

UseStartup 
< 
Startup #
># $
($ %
)% &
. 
Build 
( 
) 
; 
} 
} Ë
_C:\Users\Tamara\Desktop\Work\Anul 3\DotNet\Proiect\KunFooD\SourceCode\KunFooD\WebApp\Startup.cs
	namespace 	
WebApp
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddTransient !
<! "
IDatabaseContext" 2
,2 3
DatabaseContext4 C
>C D
(D E
)E F
;F G
services 
. 
AddTransient !
<! "
IUsersRepository" 2
,2 3
UsersRepository4 C
>C D
(D E
)E F
;F G
var 
	conection 
= 
$str p
;p q
services 
. 
AddDbContext !
<! "
DatabaseContext" 1
>1 2
(2 3
options3 :
=>; =
options> E
.E F
UseSqlServerF R
(R S
	conectionS \
)\ ]
)] ^
;^ _
services 
. 
AddMvc 
( 
) 
; 
services   
.   
AddSwaggerGen   "
(  " #
c  # $
=>  % '
{!! 
c"" 
."" 

SwaggerDoc"" 
("" 
$str"" !
,""! "
new""# &
Info""' +
{"", -
Title"". 3
=""4 5
$str""6 C
,""C D
Version""E L
=""M N
$str""O S
}""T U
)""U V
;""V W
}## 
)## 
;## 
}$$ 	
public'' 
void'' 
	Configure'' 
('' 
IApplicationBuilder'' 1
app''2 5
,''5 6
IHostingEnvironment''7 J
env''K N
)''N O
{(( 	
app** 
.** 

UseSwagger** 
(** 
)** 
;** 
app-- 
.-- 
UseSwaggerUI-- 
(-- 
c-- 
=>-- !
{.. 
c// 
.// 
SwaggerEndpoint// !
(//! "
$str//" <
,//< =
$str//> J
)//J K
;//K L
}00 
)00 
;00 
if22 
(22 
env22 
.22 
IsDevelopment22 !
(22! "
)22" #
)22# $
{33 
app44 
.44 %
UseDeveloperExceptionPage44 -
(44- .
)44. /
;44/ 0
app55 
.55 
UseBrowserLink55 "
(55" #
)55# $
;55$ %
}66 
else77 
{88 
app99 
.99 
UseExceptionHandler99 '
(99' (
$str99( 5
)995 6
;996 7
}:: 
app<< 
.<< 
UseStaticFiles<< 
(<< 
)<<  
;<<  !
app>> 
.>> 
UseMvc>> 
(>> 
routes>> 
=>>>  
{?? 
routes@@ 
.@@ 
MapRoute@@ 
(@@  
nameAA 
:AA 
$strAA #
,AA# $
templateBB 
:BB 
$strBB F
)BBF G
;BBG H
}CC 
)CC 
;CC 
}DD 	
}EE 
}FF 